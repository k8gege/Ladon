Ladon 5.5
Author K8gege
Update 20191109
===============================================================================================

@使用说明
https://github.com/k8gege/Ladon/wiki
===============================================================================================

@关于
===============================================================================================
Ladon是希腊神话中的神兽，看守金苹果的百头巨龙。它从不睡觉，被赫拉克勒斯借扛天巨人之手诱巨龙睡着，
杀死巨龙并偷得了金苹果。巨龙死前将自己的魂魄封印在金苹果中，偷盗者将金苹果送给了白雪公主，公主
为了报恩将金苹果分给了七个小矮人，吃下以后他们变成了龙珠散落到世界各地，龙珠分为七颗，它蕴含着
可以令奇迹发生的力量。当集齐7颗龙珠念出咒语，就能召唤神龙，而神龙则会实现召唤者提出的一个愿望。
虽然有些愿望是神龙无法实现的，例如超出自己能力范围的事，但它却可以自定义POC，甚至一键GetShell。

@前言
===============================================================================================
无论内网还是外网渗透信息收集都是非常关键，信息收集越多越准确渗透的成功率就越高。
但成功率还受到漏洞影响，漏洞受时效性影响，对于大型内网扫描速度直接影响着成功率。
漏洞时效性1-2天，扫描内网或外网需1周时间，是否会因此错过很多或许可成功的漏洞？
对于那些拥有几百上千域名的大站来说，你发现越快成功率就越高，慢管理员就打补丁了。
因此我们需要一个支持批量C段/B段甚至A段的扫描器，添加自定义模块快速检测新出漏洞。


@程序简介
===============================================================================================
Ladon一款用于大型网络渗透的多线程插件化综合扫描神器，含端口扫描、服务识别、网络资产、密码爆破、漏洞检测以及一键GetShell
支持批量A段/B段/C段以及跨网段扫描，支持URL、主机、域名列表扫描。5.5版本内置39个功能,通过多种协议以及方法快速获取目标网络
存活主机IP、计算机名、工作组、共享资源、网卡地址、操作系统版本、C段网站、子域名、中间件、开放服务、路由器、数据库等信息
漏洞检测包含MS17010、Weblogic、ActiveMQ、Tomcat等，密码爆破11种含数据库(Mysql、Oracle、MSSQL)、FTP、SSH(Linux)、VNC
Windows密码爆破(IPC、WMI、SMB)、Weblogic后台、Rar压缩包密码等，Web指纹识别模块可识别75种（Web应用、中间件、脚本类型）等
可高度自定义POC支持.NET程序集、DLL(C#/Delphi/VC)、PowerShell等语言编写的插件,支持通过配置INI批量调用任意外部程序或命令
EXP生成器一键生成Web漏洞POC,可快速扩展扫描或利用能力。支持Cobalt Strike插件化直接内存加载Ladon扫描快速拓展内网横向移动
===============================================================================================

@使用简单
===============================================================================================
虽然Ladon功能丰富多样,但使用却非常简单,任何人都能轻易上手
只需一或两个参数就可用90%的功能,一个模块相当于一个新工具

@运行环境
===============================================================================================
Ladon.exe可在安装有.net 2.0及以上版本Win系统中使用(Win7后系统自带.net)
如Cmd、PowerShell、远控Cmd、WebShell等，以及Cobalt Strike内存加载使用

@奇葩条件
===============================================================================================
实战并不那么顺利，有些内网转发后很卡或无法转发，只能将工具上传至目标
有些马可能上传两三M的程序都要半天甚至根本传不了，PY的几十M就更别想了
Ladon采用C#研发，程序体积非常小500K左右，即便马不行也能传500K程序吧
还不行也可PowerShell远程内存加载,这点是PY或GO编译的大程序无法比拟的


@宗旨
===============================================================================================
为用户提供一个简单易用、功能丰富、高度灵活、可定制的扫描工具，减少大量重复操作提高工作效率

@程序参数功能
===============================================================================================
1  支持指定IP扫描
2  支持指定域名扫描
3  支持指定机器名扫描
4  支持指定C段扫描(ip/24)
5  支持指定B段扫描(ip/16)
6  支持指定A段扫描(ip/8)
7  支持指定URL扫描
8  支持批量IP扫描(ip.txt)
9  支持批量C段扫描(ip24.txt)
10 支持批量B段扫描(ip16.txt)
11 支持批量URL扫描(url.txt)
12 支持批量域名扫描(domain.txt)
13 支持批量机器名扫描(host.txt)
14 支持批量字符串列表(str.txt)
15 支持主机帐密列表(check.txt)
16 支持用户密码列表(userpass.txt)
17 支持指定范围C段扫描
18 支持参数加载自定义DLL（仅限C#）
19 支持参数加载自定义EXE（仅限C#）
20 支持参数加载自定义INI配置文件
21 支持参数加载自定义PowerShell
22 支持自定义程序(系统命令或第三方程序即任意语言开发的程序或脚本)
23 支持自定义模块(支持多种语言编写的DLL/.NET程序集/PowerShell脚本)
24 支持Cobalt Strike(beacon命令行下扫描目标内网或跳板扫描外网目标)
===============================================================================================


@内置功能模块[39]


0x001 资产扫描
===============================================================================================
例子: Ladon OnlinePC(扫当前机器所处C段，其它模块同理)
例子: Ladon 192.168.1.8/24 OnlinePC

1  OnlinePC         存活主机扫描
2  OnlineIP         仅存活主机IP
3  UrlScan          URL域名扫描
4  SameWeb          同服域名扫描
5  WebScan          Web信息扫描
6  WebDir           后台目录扫描
7  SubDomain        子域名爆破
8  DomainIP         域名解析IP
9  HostIP           主机名转IP


0x002 指纹识别/服务识别
===============================================================================================
例子: Ladon OsScan
例子: Ladon 192.168.1.8/24 OsScan

1  OsScan           操作系统版本探测
2  PortScan         端口扫描含Banner
3  WebBanner        内网Web信息扫描
4  WhatCMS          75种Web指纹识别
5  CiscoScan        思科设备扫描
6  EnumMssql        枚举Mssql数据库主机
7  EnumShare        枚举网络共享资源

0x003 口令检测/密码爆破
[自定义端口(IP:端口)、帐密检测(用户 密码)、主机帐密检测(IP 端口 数据库 用户 密码)]
===============================================================================================
例子: Ladon SshScan
例子: Ladon 192.168.1.8/24 SshScan
例子: Ladon 192.168.1.8:22 SshScan (指定端口)
例子: Ladon test.rar RarScan

1  WmiScan          Wmi密码爆破(Windowns)
2  IpcScan          Ipc密码爆破(Windows)
3  SmbScan          SMB密码爆破(Windows)
4  SshScan          SSH密码爆破(Linux)
5  MssqlScan        Mssql数据库密码爆破
6  OracleScan       Oracle数据库密码爆破
7  MysqlScan        Mysql数据库密码爆破
8  WeblogicScan     Weblogic后台密码爆破
9  VncScan          VNC远程桌面密码爆破
10 FtpScan          Ftp服务器密码爆破
11 RarScan          Rar压缩包密码爆破

0x004 漏洞检测/漏洞利用
===============================================================================================
例子: Ladon MS17010
例子: Ladon 192.168.1.8/24 MS17010
例子: Ladon http://192.168.1.8 WeblogicExp

1  MS17010          SMB漏洞检测(CVE-2017-0143/CVE-2017-0144/CVE-2017-0145/CVE-2017-0146/CVE-2017-0148)
2  WeblogicPoc      Weblogic漏洞检测(CVE-2019-2725)
3  PhpStudyPoc      PhpStudy后门检测(phpstudy 2016/phpstudy 2018)
4  ActivemqPoc      ActiveMQ漏洞检测(CVE-2016-3088) 
5  TomcatPoc        Tomcat漏洞检测(CVE-2017-12615)
6  WeblogicExp      Weblogic漏洞利用(CVE-2019-2725)
7  TomcatExp        Tomcat漏洞利用(CVE-2017-12615)
8  Struts2Poc       Struts2漏洞检测(S2-005/S2-009/S2-013/S2-016/S2-019/S2-032/DevMode)

0x006 加密解密
===============================================================================================
例子: Ladon 字符串 EnHex
例子: Ladon EnHex (批量str.txt)

1  EnHex            批量Hex密码加密
2  DeHex            批量Hex密码解密
3  EnBase64         批量Base64密码加密
4  DeBase64         批量Base64密码解密


注：以上仅是该工具内置模块的初级用法，外置插件或更高级用法请查看使用文档
    中级用法INI文件配置调用任意程序、系统命令、各种语言现成EXP的批量利用
    高级用法Exp生成器一键生成Poc，使用各种语言编写插件扩展Ladon扫描能力。


@外置插件模块[9]
===============================================================================================
1  漏洞扫描 CVE 2019-0708 Windows Rdp 3389远程代码执行
2  漏洞利用 ThinkPHP 5.0.22 5.1.29 RCE GetShell Exploit
3  漏洞利用 CVE-2019-9621 Zimbra GetShell Exploit
4  漏洞利用 CVE-2019-0604 SharePoint GetShell Exploit
5  漏洞利用 CVE 2016-3088 ActiveMQ GetShell Exploit
6  漏洞利用 Apache Solr 8.2.0 Velocity RCE 0day Exploit
7  漏洞利用 PhpStudy后门 GetShell Exploit
8  INI调用外部程序命令 批量SSH上控
9  INI调用外部程序命令 批量Win上控
